This requires file reading so this function uses fstream